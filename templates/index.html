<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Virtual Downloader</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            transition: all .2s ease-in-out;
        }

        body {
            width: 100%;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            overflow-x: hidden;
        }

        :root {
            --txtclr: black;
            --thclr: #7017FF;
            --thmclr: white;
        }

        .df {
            display: flex;
        }

        .r {
            flex-direction: row;
        }

        .sa {
            justify-content: space-around;
        }

        .ca {
            align-items: center;
        }

        .lg {
            color: var(--txtclr);
        }

        .un {
            text-decoration: none;
        }

        .bb {
            font-weight: 800;
        }

        .asd {
            color: var(--thclr);
        }



        nav {
            width: 100%;
            height: 80px;
            position: fixed;
            width: 100%;
            top: 0;
            left: 0;
            border-bottom: 2px solid black;
            background-color: white;
            z-index: 10000;

        }

        #form {
            margin-top: 80px;
            width: 100%;
            padding: 10px;
            background: rgba(217, 217, 217, 0.20);
            height: 300px;

        }

        .inp {
            width: 500px;
            height: 60px;
            padding: 0px 10px;
            color: black;
            background-color: var(--thmclr);
            outline: none;
            border: none;
            border-radius: 15px;
            font-weight: bold;
            font-size: 20px;

        }

        .cover video {
            width: 100%;
            height: auto;
        }

        .clrbd {
            border-radius: 20px;
            width: fit-content;
            padding: 4px;
            height: fit-content;
            /* border: 2px solid black; */
            background: linear-gradient(to right, rgba(112, 23, 255, 1), rgba(255, 27, 144, 1), rgba(197, 0, 233, 1));
        }

        .col {
            flex-direction: column;
        }

        .btns {
            width: 300px;
            height: 60px;
            flex-shrink: 0;
            border-radius: 20px;
            border: 0px solid #000;
            background: linear-gradient(87deg, #F80261 0%, #7017FF 47.92%, #C500E9 100%);
            color: white;
            font-size: 30px;
            cursor: pointer;
            transition: all;
            transform: scale(1);
            transition-duration: 0.5s;


        }

        .btns:hover {
            transform: scale(1.1);
            box-shadow: 0px 10px 10px rgba(0, 0, 0, 0.234);
        }

        .infb {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            font-size: 30px;
            font-weight: 600;
            letter-spacing: 2px;
        }

        .rs {
            color: rgba(112, 23, 255, 1);
        }

        .vs {
            color: rgba(197, 0, 233, 1);
        }

        .is {
            color: rgba(255, 27, 144, 1);
        }

        .wp {
            flex-wrap: wrap;
        }
.jc{
    justify-content: center;
}
        #content {
            max-width: 1300px;
            margin-top: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            flex-direction: row;
            flex-wrap: wrap;
            width: 100%;


        }

        .dcard {
            width: 400px;
            height: auto;
            border: 1px solid black;
            border-radius: 10px;
        }

        .profilerr {


            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-direction: row;
            border-bottom: 2px solid black;
            padding: 5px 0px;

        }

        .profilerr img {
            width: 50px;
            border: 2px solid black;
            border-radius: 30px;
            margin-left: 10px;
        }

        .pun {
            margin-right: 10px;

        }

        .cover img {
            width: 100%;
            height: auto;
        }

        .dowlik {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;

        }

        .dowlik a {
            width: 250px;
            height: 50px;
            border-radius: 10px;
            background-color: #7017FF;
            display: flex;
            justify-content: center;
            align-items: center;
            color: rgb(255, 255, 255);
            text-decoration: none;
            font-weight: 600;
            margin-bottom: 10px;

        }

        /* Loading */

        .loader {
            border: 10px solid rgba(0, 0, 0, 0.447);
            border-top: 10px solid #F80261;
            border-bottom: 10px solid #7017FF;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: none;

            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        @media (max-width:600px) {
            #form {
                padding: 10px;
            }

            .clrbd {
                width: 97%;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            .inp {
                width: 96%;
            }

            .btns {
                width: 95%;
            }

            .infb {
                font-size: 20px;
            }

            .inf2 {
                justify-content: center;

            }

            .lg {
                font-size: 20px;
            }

            .asd {
                font-size: 15px;
            }
        }
    </style>
</head>

<body>

    <nav class="df r sa ca">
        <a class=" un" href="#">

            <h1 class="lg">Virtual Downloader</h1>
        </a>
        <a class="bb asd " href="#">How To Download ?</a>
    </nav>

    <div id="form" class="df col sa ca">
        <div class="clrbd">

            <input type="text" id="postUrlInputIg" class="inp"
                placeholder="Enter Instagram Post, Reel, IGTV URL">
        </div>
        <button id="downloadButtonig" class="btns">Download</button>
        <div class="infb">
            <div class="df r ca nor">Download Instagram </div>
            <div class="df r ca sa wp inf2">

                <span class="rs"> Reels |</span>
                <span class="vs"> Videos |</span>
                <span class="is"> Images |</span>
                <!-- <span class="rs"> Stories |</span> -->
                <span class="vs"> IGTV</span>
            </div>

        </div>


    </div>
    <div class="df c ca jc " style="width: 100%;">
    <section id="content">

        <div class="loader" id="loader"></div>
    </section>

</div>

    <script>

        var title = document.getElementById("title")
        var content = document.getElementById("content")
        var download = document.getElementById("download")



        // download the file
        function downloadFile(posturl, type) {
            const fileUrl = posturl; // Replace with the API endpoint URL

            fetch(posturl)
                .then(response => {
                    if (response.ok) {
                        return response.blob();
                    } else {
                        throw new Error('Error downloading file.');
                    }
                })
                .then(blob => {
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    if (type == "video") {
                        link.download = 'IGVIDEO.mp4';
                    }
                    else {
                        link.download = 'IGPOST.png';

                    }
                    // Specify the desired file name for the downloaded file
                    link.click();
                    URL.revokeObjectURL(url);
                })
                .catch(error => {
                    console.error(error);
                });
        }
        // download video 
        function reqdownload() {
            var linkf = document.getElementById("postUrlInputIg").value;
            var url = "http://127.0.0.1:8000/insta?link=" + linkf
            var type = "video"
            downloadFile(url, type)
        }
        // download image
        function reqdownloadimg() {
            var linkf = document.getElementById("postUrlInputIg").value;
            var url = "http://127.0.0.1:8000/insta?link=" + linkf
            var type = "image"
            downloadFile(url, type)
        }

        var igdownload = document.getElementById("downloadButtonig")
        var loader = document.getElementById("loader")

        igdownload.addEventListener("click", () => {
            loader.style.display = "flex";
            var linkf = document.getElementById("postUrlInputIg").value;
            var url = "http://127.0.0.1:8000/insta?link=" + linkf
            fetch(url, { mode: 'cors', method: "GET" })
                .then((response) => response.json())
                .then((data) => {
                   


                    const videos = data.videourls;
                    const images = data.imageurls;
                    if (videos.length == 1) {
                        loader.style.display = "none";

                        content.innerHTML += `
                            <div class="dcard">
                                <div class="profilerr">

                                    <img src="https://cdn-icons-png.flaticon.com/512/3106/3106773.png" alt="profile">
                                    <span class="pun" >${data.username}</span>
                                </div>
                                <div class="cover">
                                    <video src="${videos[0]}" controls ></video>
                                </div>
                                <div class="dowlik">
                                    <a href="${videos[0]}">Download Video</a>
                                </div>
                            </div>`
                    }
                    if (images.length == 1) {
                        loader.style.display = "none";

                        content.innerHTML += `
                             <div class="dcard">
                            <div class="profilerr">
                                <img src="https://cdn-icons-png.flaticon.com/512/3106/3106773.png" alt="profile">
                                <span class="pun" >${data.username}</span>
                            </div>
                            <div class="cover">
                                <img src="${images[0]}" alt="expired">
                            </div>
                            <div class="dowlik">
                                <a href="${images[0]}">Download Image</a>
                            </div>
                            </div> 

                        `
                    }
                    if (videos.length > 1) {

                        for (let index = 0; index < videos.length; index++) {
                            loader.style.display = "none";

                            content.innerHTML += `
                                <div class="dcard">
                                    <div class="profilerr">

                                        <img src="https://cdn-icons-png.flaticon.com/512/3106/3106773.png" alt="profile">
                                        <span class="pun" >${data.username}</span>
                                    </div>
                                    <div class="cover">
                                        <video src="${videos[index]}" controls ></video>
                                    </div>
                                    <div class="dowlik">
                                        <a href="${videos[index]}">Download Video</a>
                                    </div>
                                </div> 
    `
                        }
                    }
                    if (images.length > 1) {
                        for (let index = 0; index < images.length; index++) {
                            loader.style.display = "none";

                            content.innerHTML += `
                            <div class="dcard">
                                <div class="profilerr">
                                    <img src="https://cdn-icons-png.flaticon.com/512/3106/3106773.png" alt="profile">
                                    <span class="pun" >${data.username}</span>
                                </div>
                                <div class="cover">
                                    <img src="${images[index]}" alt="expired">
                                </div>
                                <div class="dowlik">
                                    <a href="${images[index]}">Download Image</a>
                                </div>
                            </div> 

                        `

                        }
                    }

                }
                
                ).catch(error =>
                content.innerHTML = `<h1>Please check Your URL or Check if the Account is Not PRIVATE</h1>`
            )
        })
            
    </script>
</body>

</html>